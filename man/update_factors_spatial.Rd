% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/updates.R
\name{update_factors_spatial}
\alias{update_factors_spatial}
\title{Update Latent Factor Scores in Spatial Model}
\usage{
update_factors_spatial(K, x, lambda, alpha, mu)
}
\arguments{
\item{K}{Current precision matrix (p x p)}

\item{x}{Data matrix (n x p) for the current group}

\item{lambda}{Current loading vector (length p)}

\item{alpha}{Current intercept vector (length p)}

\item{mu}{Current mean parameter for the factors}
}
\value{
A vector of updated factor scores (length n)
}
\description{
Updates the latent factor scores (f) for observations in a spatial model using Gibbs sampling.
The function calculates conditional posterior distributions for each factor score and samples
from these distributions.
}
\details{
For each observation j, the function:
\enumerate{
\item Calculates the conditional posterior mean for f\link{j}
\item Calculates the conditional posterior variance
\item Samples a new f\link{j} from the normal distribution
\item Centers the final factor scores
}
}
\examples{
# Example usage:
# updated_f <- update_factors_spatial(K, x, lambda, alpha, mu)

}
